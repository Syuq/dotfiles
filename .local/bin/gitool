#!/bin/bash

error() { echo -e "$1" && exit; }

[ $EUID -eq 0 ] && error "Do not run this script as root."

usage() {
    echo "Usage: gitool <option> <argument>
                    [-a | --add <file>]
                    [-m | --message <commit message>]
                    [-p | --push]
                    [-c | --clone]
                    [-h | --help]"
    exit
}

PARSED_ARGUMENTS=$(getopt -a -n $0 -o a:m:pch -l add:,message:,push,clone,help -- "$@")
[ $? -ne 0 ] && usage

while :; do
    case "${1}" in
        -a | --add)	file=$2 ; shift 2 ;;
        -m | --message)	message=$2 ; shift 2 ;;
        -p | --push)	push="true" ; shift ;;
        -c | --clone)	clone="true" ; shift ;;
        -h | --help)	usage ;;
        -- | '')        shift; break ;;
        *) echo "Unexpected option: $1 is not a valid option." ; usage ;;
    esac
done

[ -n "$file" ]      && git add "$file"
[ -n "$message" ]   && git commit -m "$file: $message"
[ -n "$push" ]      && git push
[ -n "$clone" ]     && git clone "$(xclip -o)"

exit 0
